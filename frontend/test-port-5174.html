<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Port 5174 Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Port 5174 Test</h1>
        <p>Testing if the sponsorship server is running on port 5174</p>
        
        <button onclick="testHealth()">üè• Test Health</button>
        <button onclick="testCreateSponsorship()">‚ûï Create Grace Sponsorship</button>
        <button onclick="testGetSponsorships()">üìã Get Sponsorships</button>
        <button onclick="testGetStudents()">üìö Get Students</button>
        
        <div id="result"></div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:5174/api';
        
        function showResult(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result ${type}`;
            resultDiv.textContent = message;
        }

        async function testHealth() {
            try {
                showResult('Testing health endpoint on port 5174...', 'info');
                const response = await fetch(`${API_BASE_URL}/health`);
                if (response.ok) {
                    const data = await response.json();
                    showResult(`‚úÖ Server is running on port 5174!\n\n${JSON.stringify(data, null, 2)}`, 'success');
                } else {
                    showResult(`‚ùå Health check failed: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Health check error: ${error.message}\n\nThis means the server is not running on port 5174.`, 'error');
            }
        }

        async function testCreateSponsorship() {
            try {
                showResult('Creating Grace Nakato sponsorship on port 5174...', 'info');
                
                const sponsorshipData = {
                    studentId: '1',
                    studentName: 'Nakato Grace',
                    sponsorName: 'Test Sponsor',
                    sponsorEmail: 'test@example.com',
                    sponsorPhone: '+256700000000',
                    sponsorCountry: 'Uganda',
                    sponsorCity: 'Kampala',
                    sponsorRelationship: 'Individual',
                    amount: 500000,
                    duration: 12,
                    sponsorshipStartDate: new Date().toISOString().split('T')[0],
                    message: 'I would like to sponsor Grace Nakato for her education. She dreams of becoming a doctor.',
                    paymentMethod: 'Bank Transfer',
                    preferredContactMethod: 'Email',
                    sponsorId: 'test-sponsor-' + Date.now()
                };

                const response = await fetch(`${API_BASE_URL}/sponsorships`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(sponsorshipData),
                });

                if (response.ok) {
                    const data = await response.json();
                    showResult(`‚úÖ Sponsorship created on server!\n\nID: ${data.id}\nStatus: ${data.status}\n\n${JSON.stringify(data, null, 2)}`, 'success');
                } else {
                    const errorText = await response.text();
                    showResult(`‚ùå Failed to create sponsorship: ${response.status} ${response.statusText}\n\n${errorText}`, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Error creating sponsorship: ${error.message}`, 'error');
            }
        }

        async function testGetSponsorships() {
            try {
                showResult('Getting sponsorships from server...', 'info');
                const response = await fetch(`${API_BASE_URL}/sponsorships`);
                if (response.ok) {
                    const data = await response.json();
                    showResult(`‚úÖ Got ${data.length} sponsorships from server!\n\n${JSON.stringify(data, null, 2)}`, 'success');
                } else {
                    showResult(`‚ùå Failed to get sponsorships: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Error getting sponsorships: ${error.message}`, 'error');
            }
        }

        async function testGetStudents() {
            try {
                showResult('Getting students from server...', 'info');
                const response = await fetch(`${API_BASE_URL}/students`);
                if (response.ok) {
                    const data = await response.json();
                    showResult(`‚úÖ Got ${data.length} students from server!\n\n${JSON.stringify(data, null, 2)}`, 'success');
                } else {
                    showResult(`‚ùå Failed to get students: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showResult(`‚ùå Error getting students: ${error.message}`, 'error');
            }
        }

        // Auto-test on page load
        window.onload = function() {
            showResult('üöÄ Port 5174 Test Page Loaded\n\nClick "Test Health" to check if the server is running on port 5174.\n\nIf successful, you can then test creating and getting sponsorships from the server.', 'info');
        };
    </script>
</body>
</html>
